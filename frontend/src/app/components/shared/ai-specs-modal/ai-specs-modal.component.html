@if (isOpen) {
  <div 
    class="fixed inset-0 z-[100] flex items-center justify-center p-4"
    (click)="onBackdropClick($event)"
  >
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    
    <!-- Modal -->
    <div class="relative w-full max-w-4xl max-h-[90vh] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden">
      
      <!-- Header -->
      <div class="flex items-center justify-between p-6 border-b border-stone-200 bg-gradient-to-r from-stone-900 to-stone-800">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
          </div>
          <div>
            <h2 class="font-serif text-xl text-white">Especificaciones con IA</h2>
            <p class="text-sm text-white/70">{{ brand }} {{ model }} {{ year }}</p>
          </div>
        </div>
        <button
          (click)="close()"
          class="p-2 hover:bg-white/10 rounded-lg transition-colors"
        >
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      
      <!-- Content -->
      <div class="flex-1 overflow-y-auto p-6">
        
        <!-- Loading State -->
        @if (loading()) {
          <div class="flex flex-col items-center justify-center py-16">
            <div class="relative">
              <div class="w-16 h-16 border-4 border-stone-200 border-t-stone-800 rounded-full animate-spin"></div>
              <div class="absolute inset-0 flex items-center justify-center">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-stone-600">
                  <circle cx="12" cy="12" r="3"/>
                  <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                </svg>
              </div>
            </div>
            <p class="mt-4 text-stone-600 font-medium">Consultando informacion del vehiculo...</p>
            <p class="text-sm text-stone-500">La IA esta buscando las especificaciones</p>
          </div>
        }
        
        <!-- Error State -->
        @if (error() && !loading()) {
          <div class="flex flex-col items-center justify-center py-16">
            <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-red-600">
                <circle cx="12" cy="12" r="10"/>
                <line x1="15" y1="9" x2="9" y2="15"/>
                <line x1="9" y1="9" x2="15" y2="15"/>
              </svg>
            </div>
            <p class="text-stone-900 font-medium mb-2">No se pudo obtener la informacion</p>
            <p class="text-sm text-stone-600 mb-4 text-center max-w-md">{{ error() }}</p>
            <button
              (click)="retry()"
              class="px-6 py-2 bg-stone-900 hover:bg-stone-800 text-white rounded-lg font-medium transition-colors"
            >
              Intentar de nuevo
            </button>
          </div>
        }
        
        <!-- Specs Content -->
        @if (specs() && !loading() && !error()) {
          <div class="space-y-6">
            
            <!-- Summary -->
            <div class="bg-gradient-to-r from-stone-100 to-stone-50 rounded-xl p-5 border border-stone-200">
              <div class="flex items-start space-x-3">
                <div class="w-8 h-8 bg-stone-900 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                  </svg>
                </div>
                <div>
                  <p class="text-xs text-stone-500 uppercase tracking-wider mb-1">Resumen IA</p>
                  <p class="text-stone-700 leading-relaxed">{{ specs()!.summary }}</p>
                </div>
              </div>
            </div>
            
            <!-- Grid de Especificaciones -->
            <div class="grid md:grid-cols-2 gap-6">
              
              <!-- Motor -->
              <div class="bg-white border border-stone-200 rounded-xl p-5 shadow-sm">
                <div class="flex items-center space-x-2 mb-4">
                  <div class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-red-600">
                      <circle cx="12" cy="12" r="3"/>
                      <path d="M12 1v6m0 6v6"/>
                      <path d="M1 12h6m6 0h6"/>
                    </svg>
                  </div>
                  <h3 class="font-serif text-lg text-stone-900">Motor</h3>
                </div>
                <div class="space-y-3">
                  <div class="flex justify-between items-center py-2 border-b border-stone-100">
                    <span class="text-sm text-stone-600">Tipo</span>
                    <span class="text-sm font-medium text-stone-900">{{ specs()!.engine.type }}</span>
                  </div>
                  <div class="flex justify-between items-center py-2 border-b border-stone-100">
                    <span class="text-sm text-stone-600">Cilindrada</span>
                    <span class="text-sm font-medium text-stone-900">{{ specs()!.engine.displacement }}</span>
                  </div>
                  <div class="flex justify-between items-center py-2 border-b border-stone-100">
                    <span class="text-sm text-stone-600">Potencia</span>
                    <span class="text-sm font-medium text-stone-900 text-red-600">{{ specs()!.engine.horsepower }}</span>
                  </div>
                  <div class="flex justify-between items-center py-2">
                    <span class="text-sm text-stone-600">Torque</span>
                    <span class="text-sm font-medium text-stone-900">{{ specs()!.engine.torque }}</span>
                  </div>
                </div>
              </div>
              
              <!-- Rendimiento -->
              <div class="bg-white border border-stone-200 rounded-xl p-5 shadow-sm">
                <div class="flex items-center space-x-2 mb-4">
                  <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600">
                      <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                      <path d="M2 17l10 5 10-5"/>
                      <path d="M2 12l10 5 10-5"/>
                    </svg>
                  </div>
                  <h3 class="font-serif text-lg text-stone-900">Rendimiento</h3>
                </div>
                <div class="space-y-3">
                  <div class="flex justify-between items-center py-2 border-b border-stone-100">
                    <span class="text-sm text-stone-600">Velocidad maxima</span>
                    <span class="text-sm font-medium text-blue-600">{{ specs()!.performance.topSpeed }}</span>
                  </div>
                  <div class="flex justify-between items-center py-2 border-b border-stone-100">
                    <span class="text-sm text-stone-600">0-100 km/h</span>
                    <span class="text-sm font-medium text-stone-900">{{ specs()!.performance.acceleration }}</span>
                  </div>
                  <div class="flex justify-between items-center py-2">
                    <span class="text-sm text-stone-600">Consumo</span>
                    <span class="text-sm font-medium text-emerald-600">{{ specs()!.performance.fuelConsumption }}</span>
                  </div>
                </div>
              </div>
              
              <!-- Dimensiones -->
              <div class="bg-white border border-stone-200 rounded-xl p-5 shadow-sm">
                <div class="flex items-center space-x-2 mb-4">
                  <div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-amber-600">
                      <rect x="3" y="8" width="18" height="12" rx="2"/>
                      <path d="M8 8V6a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                    </svg>
                  </div>
                  <h3 class="font-serif text-lg text-stone-900">Capacidades</h3>
                </div>
                <div class="space-y-3">
                  <div class="flex justify-between items-center py-2 border-b border-stone-100">
                    <span class="text-sm text-stone-600">Cajuela</span>
                    <span class="text-sm font-medium text-amber-600">{{ specs()!.dimensions.trunkCapacity }}</span>
                  </div>
                  <div class="flex justify-between items-center py-2 border-b border-stone-100">
                    <span class="text-sm text-stone-600">Tanque combustible</span>
                    <span class="text-sm font-medium text-stone-900">{{ specs()!.dimensions.fuelTankCapacity }}</span>
                  </div>
                  <div class="flex justify-between items-center py-2">
                    <span class="text-sm text-stone-600">Peso</span>
                    <span class="text-sm font-medium text-stone-900">{{ specs()!.dimensions.weight }}</span>
                  </div>
                </div>
              </div>
              
              <!-- TecnologÃ­a -->
              <div class="bg-white border border-stone-200 rounded-xl p-5 shadow-sm">
                <div class="flex items-center space-x-2 mb-4">
                  <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-purple-600">
                      <rect x="4" y="4" width="16" height="16" rx="2"/>
                      <rect x="9" y="9" width="6" height="6"/>
                      <line x1="9" y1="1" x2="9" y2="4"/>
                      <line x1="15" y1="1" x2="15" y2="4"/>
                      <line x1="9" y1="20" x2="9" y2="23"/>
                      <line x1="15" y1="20" x2="15" y2="23"/>
                      <line x1="20" y1="9" x2="23" y2="9"/>
                      <line x1="20" y1="14" x2="23" y2="14"/>
                      <line x1="1" y1="9" x2="4" y2="9"/>
                      <line x1="1" y1="14" x2="4" y2="14"/>
                    </svg>
                  </div>
                  <h3 class="font-serif text-lg text-stone-900">Entretenimiento</h3>
                </div>
                <div class="flex flex-wrap gap-2">
                  @for (item of specs()!.technology.infotainment; track $index) {
                    <span class="px-3 py-1 bg-purple-50 text-purple-700 text-xs font-medium rounded-full border border-purple-200">
                      {{ item }}
                    </span>
                  }
                </div>
              </div>
              
            </div>
            
            <!-- Seguridad y Confort - Full width -->
            <div class="grid md:grid-cols-2 gap-6">
              
              <!-- Seguridad -->
              <div class="bg-white border border-stone-200 rounded-xl p-5 shadow-sm">
                <div class="flex items-center space-x-2 mb-4">
                  <div class="w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-emerald-600">
                      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    </svg>
                  </div>
                  <h3 class="font-serif text-lg text-stone-900">Seguridad</h3>
                </div>
                <div class="flex flex-wrap gap-2">
                  @for (item of specs()!.technology.safety; track $index) {
                    <span class="px-3 py-1 bg-emerald-50 text-emerald-700 text-xs font-medium rounded-full border border-emerald-200">
                      {{ item }}
                    </span>
                  }
                </div>
              </div>
              
              <!-- Confort -->
              <div class="bg-white border border-stone-200 rounded-xl p-5 shadow-sm">
                <div class="flex items-center space-x-2 mb-4">
                  <div class="w-8 h-8 bg-stone-100 rounded-lg flex items-center justify-center">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-stone-600">
                      <path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/>
                      <line x1="16" y1="8" x2="2" y2="22"/>
                      <line x1="17.5" y1="15" x2="9" y2="15"/>
                    </svg>
                  </div>
                  <h3 class="font-serif text-lg text-stone-900">Confort</h3>
                </div>
                <div class="flex flex-wrap gap-2">
                  @for (item of specs()!.technology.comfort; track $index) {
                    <span class="px-3 py-1 bg-stone-100 text-stone-700 text-xs font-medium rounded-full border border-stone-200">
                      {{ item }}
                    </span>
                  }
                </div>
              </div>
              
            </div>
            
            <!-- Disclaimer -->
            <div class="bg-stone-50 rounded-lg p-4 border border-stone-200">
              <div class="flex items-start space-x-2">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-stone-500 mt-0.5 flex-shrink-0">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="12" y1="16" x2="12" y2="12"/>
                  <line x1="12" y1="8" x2="12.01" y2="8"/>
                </svg>
                <p class="text-xs text-stone-500">
                  Esta informacion fue generada por inteligencia artificial y puede variar segun la version especifica del vehiculo. 
                  Consulta con nuestro equipo para confirmar las especificaciones exactas del auto que rentaras.
                </p>
              </div>
            </div>
            
          </div>
        }
        
      </div>
      
      <!-- Footer -->
      <div class="p-4 border-t border-stone-200 bg-stone-50 flex justify-end">
        <button
          (click)="close()"
          class="px-6 py-2.5 bg-stone-900 hover:bg-stone-800 text-white rounded-lg font-medium transition-colors"
        >
          Cerrar
        </button>
      </div>
    </div>
  </div>
}
